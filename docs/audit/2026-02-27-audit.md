# Code Quality Audit — 2026-02-27

## Formatting

Deviations from rustfmt defaults found and fixed in commit `076a86c`.
8 files had formatting changes (mostly line-length wrapping and import ordering).

## Clippy (pedantic)

28 warnings across 8 lint categories:

| Lint | Count | Action |
|---|---|---|
| `cast_precision_loss` | 6 | Allow — intentional f64 display of byte counts |
| `doc_markdown` | 5 | Fix — add backticks to type names in doc comments |
| `uninlined_format_args` | 4 | Fix — inline variables in format strings |
| `must_use_candidate` | 6 | Allow — noisy for a CLI tool |
| `missing_errors_doc` | 3 | Allow — error types are self-evident from signatures |
| `missing_panics_doc` | 2 | Allow — panics are in infallible template strings |
| `needless_continue` | 1 | Fix — remove redundant continue |
| `manual_let_else` | 1 | Fix — rewrite as let...else |

## Complexity (lizard)

49 functions analyzed. No thresholds exceeded (CCN > 15 or length > 1000).

**Highest complexity functions:**

| Function | File | CCN | NLOC |
|---|---|---|---|
| `format_report` | report.rs:8 | 12 | 74 |
| `build_plan` | plan.rs:9 | 7 | 36 |
| `format_dry_run_report` | report.rs:93 | 7 | 47 |
| `scan_backup` | scan.rs:18 | 7 | 33 |
| `write_to_restore_path` | copy.rs:115 | 6 | 26 |

`format_report` at CCN 12 is the only function approaching typical thresholds (15).
It builds a multi-section string report — the complexity comes from iterating
over different data sections, which is inherent to the task.

**Per-file averages:**

| File | NLOC | Avg CCN | Functions |
|---|---|---|---|
| report.rs | 310 | 3.2 | 9 |
| copy.rs | 373 | 2.3 | 14 |
| plan.rs | 137 | 1.9 | 7 |
| scan.rs | 140 | 1.8 | 9 |
| conflict.rs | 76 | 1.6 | 5 |
| types.rs | 113 | 1.2 | 5 |

Overall average CCN: 2.1 — well within healthy range.

## Dependencies

### Security (cargo audit)

No vulnerabilities found. One warning:

- **RUSTSEC-2025-0119**: `number_prefix 0.4.0` is unmaintained (transitive dep via `indicatif`).
  No action needed — `indicatif` will handle this upstream.

### Licenses

All dependencies use permissive licenses:

- MIT
- Apache-2.0 OR MIT
- Unlicense OR MIT
- Zlib
- (MIT OR Apache-2.0) AND Unicode-3.0
- Apache-2.0 WITH LLVM-exception OR Apache-2.0 OR MIT
- MIT OR Apache-2.0 OR LGPL-2.1-or-later

No license conflicts.
